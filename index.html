<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>پنل مدیریت فایل GitHub</title>
<style>
body{font-family:sans-serif;background:#f4f6f9;padding:30px;color:#111}
.card{max-width:720px;margin:0 auto;background:#fff;padding:18px;border-radius:8px;box-shadow:0 8px 30px rgba(0,0,0,0.06)}
input,textarea,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ddd;box-sizing:border-box}
button{background:#2563eb;color:#fff;border:none;cursor:pointer;padding:10px}
.small{font-size:13px;color:#666}
a.link{color:#2563eb}
</style>
</head>
<body>
<div class="card">
  <h2>📂 وب‌پنل ساخت فایل در GitHub</h2>

  <label>Filename</label>
  <input id="filename" placeholder="index.html">

  <label>Content</label>
  <textarea id="content" rows="4">&lt;h1&gt;سلام از Parham&lt;/h1&gt;</textarea>

  <button id="createBtn">ساخت فایل 🚀</button>

  <h4>نتیجه</h4>
  <pre id="out"></pre>
</div>

<script>
const out = document.getElementById('out');

document.getElementById('createBtn').addEventListener('click', async () => {
  const filename = document.getElementById('filename').value.trim();
  const content = document.getElementById('content').value;

  if(!filename || !content){
    out.textContent = "⚠️ لطفاً نام فایل و محتوا را وارد کنید.";
    return;
  }

  out.textContent = "⏳ درخواست به GitHub Actions ارسال شد...";

  try {
    const workflowURL = "https://api.github.com/repos/rdnsparham-rgb/V1/actions/workflows/cpanel-like.yml/dispatches";
    const res = await fetch(workflowURL, {
      method: "POST",
      headers: {
        "Accept":"application/vnd.github+json",
        "Authorization":"Bearer ghp_dummy" // placeholder: توکن واقعی داخل workflow هست
      },
      body: JSON.stringify({
        ref: "main",
        inputs: { filename, content }
      })
    });

    if(res.ok){
      out.textContent = "✅ درخواست ارسال شد!\nفایل در پوشه رندم ساخته خواهد شد.\nلینک GitHub Pages بعد از ساخته شدن: https://rdnsparham-rgb.github.io/V1/<RAND>/<filename>";
    } else {
      const data = await res.json();
      out.textContent = `❌ خطا: ${data.message}`;
    }
  } catch(e){
    out.textContent = "❌ خطا در ارتباط با GitHub: " + e.message;
  }
});
</script>
</body>
</html>
