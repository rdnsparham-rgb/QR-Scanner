<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>پنل CPanel-like GitHub</title>
</head>
<body>
<h1>پنل ساخت فایل GitHub</h1>
<form id="createForm">
  <label>نام فایل:</label>
  <input type="text" name="filename" placeholder="مثلاً Wke.md" required><br><br>
  <label>محتوا:</label><br>
  <textarea name="content" placeholder="محتوای فایل..." rows="6" cols="40"></textarea><br><br>
  <button type="submit">ساخت فایل</button>
</form>

<div id="result" style="margin-top:20px;color:green;"></div>

<script>
const form = document.getElementById('createForm');
form.addEventListener('submit', async e => {
  e.preventDefault();
  const filename = form.filename.value;
  const content = form.content.value;

  try {
    // Trigger GitHub Actions workflow dispatch API
    const repo = "rdnsparham-rgb/V1"; // ریپو خودت
    const url = `https://api.github.com/repos/${repo}/actions/workflows/cpanel-like.yml/dispatches`;
    
    const res = await fetch(url, {
      method: 'POST',
      headers: {
        'Accept': 'application/vnd.github+json',
        'Authorization': 'token YOUR_PAT_HERE' // ← این را در مرورگر قرار نده، فقط برای تست
      },
      body: JSON.stringify({
        ref: 'main',
        inputs: { filename, content }
      })
    });

    if(res.ok) {
      document.getElementById('result').innerText = "✅ فایل با موفقیت ساخته شد. بررسی workflow در Actions.";
    } else {
      const data = await res.json();
      document.getElementById('result').innerText = "❌ خطا: " + JSON.stringify(data);
    }
  } catch(err) {
    document.getElementById('result').innerText = "❌ خطای جاوااسکریپت: " + err;
  }
});
</script>
</body>
</html>
